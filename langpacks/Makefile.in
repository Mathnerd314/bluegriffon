DEPTH           = ../..
topsrcdir       = @top_srcdir@
srcdir          = @srcdir@
VPATH           = @srcdir@

include $(DEPTH)/config/autoconf.mk

APP_NAME = $(MOZ_APP_DISPLAYNAME)

ifdef MOZ_DEBUG
APP_NAME := $(APP_NAME)Debug
endif

_AVAILABLE_LOCALES =\
    en-US \
    cs \
    de \
    es-ES \
    fi \
    fr \
    gl \
    he \
    it \
    ja \
    ko \
    nl \
    pl \
    sl \
    sv-SE \
    zh-CN \
    zh-TW \
    hu \
    sr \
    $(NULL)

.PHONY: $(_AVAILABLE_LOCALES)

libs::$(_AVAILABLE_LOCALES)
ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))
	mkdir -p $(DIST)/$(APP_NAME).app/Contents/MacOS/distribution/bundles
	rm -fr $(DIST)/$(APP_NAME).app/Contents/MacOS/distribution/bundles/*
	$(foreach f,$^, mkdir $(DIST)/$(APP_NAME).app/Contents/MacOS/distribution/bundles/langpack-$f@bluegriffon.org ;)
	$(foreach f,$^, cp -r $(topsrcdir)/bluegriffon/locales/$f/* $(DIST)/$(APP_NAME).app/Contents/MacOS/distribution/bundles/langpack-$f@bluegriffon.org ; )
	$(foreach f,$^, cp -r $(srcdir)/$f/* $(DIST)/$(APP_NAME).app/Contents/MacOS/distribution/bundles/langpack-$f@bluegriffon.org ; )
else
	mkdir -p $(DIST)/bin/distribution/bundles
	rm -fr $(DIST)/bin/distribution/bundles/*
	$(foreach f,$^, mkdir $(DIST)/bin/distribution/bundles/langpack-$f@bluegriffon.org ;)
	cd $(DIST)/bin/distribution/bundles
	$(foreach f,$^, cd langpack-$f@bluegriffon.org; unzip $(topsrcdir)/bluegriffon/langpacks/langpack-$f@bluegriffon.org.xpi ;)
endif

include $(topsrcdir)/config/rules.mk

