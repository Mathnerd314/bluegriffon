diff -r 0aa98eae87ed content/base/src/nsXHTMLContentSerializer.cpp
--- a/content/base/src/nsXHTMLContentSerializer.cpp	Fri Nov 05 02:21:30 2010 -0500
+++ b/content/base/src/nsXHTMLContentSerializer.cpp	Mon Dec 27 12:21:29 2010 +0100
@@ -897,6 +897,8 @@
       name == nsGkAtoms::noframes
       ) {
     mPreLevel++;
+    if (name != nsGkAtoms::pre)
+      ++mDisableEntityEncoding;
   }
 }
 
@@ -915,6 +917,8 @@
       name == nsGkAtoms::noframes
     ) {
     --mPreLevel;
+    if (name != nsGkAtoms::pre)
+      --mDisableEntityEncoding;
   }
 }
 
@@ -1034,3 +1038,4 @@
 
   return PR_TRUE;
 }
+
