<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <style type="text/css" media="screen">
    .CodeMirror { 
        margin: 0;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: #fefefe;
    }
    .CodeMirror-scroll {height: 100% ! important}
    .CodeMirror-gutter {cursor: pointer;}
  </style>
  <link rel="stylesheet" href="resource://app/res/cm2/codemirror.css">
  <link rel="stylesheet" href="resource://app/res/cm2/foldtag.css">
  <script src="resource://app/res/cm2/codemirror.js" type="text/javascript" ></script>
  <script src="resource://app/res/cm2/searchcursor.js" type="text/javascript" ></script>
  <script src="resource://app/res/cm2/foldtag.js" type="text/javascript" ></script>
  <script src="resource://app/res/cm2/xml.js" type="text/javascript" ></script>
  <script src="resource://app/res/cm2/javascript.js" type="text/javascript" ></script>
  <script src="resource://app/res/cm2/css.js" type="text/javascript" ></script>
  <script src="resource://app/res/cm2/htmlmixed.js" type="text/javascript" ></script>
</head>
<body>

<textarea id="code" name="code"></textarea>
<script>
  var gEditor = null;
  var gChangeCallback = null;
  var gChangeTimer = null;

  window.onload = function(){
     var foldFunc = CodeMirror.newFoldFunction(CodeMirror.tagRangeFinder);
      function keyEvent(cm, e) {
        if (e.keyCode == 81 && e.ctrlKey) {
          if (e.type == "keydown") {
            e.stop();
            setTimeout(function() {foldFunc(cm, cm.getCursor().line);}, 50);
          }
          return true;
        }
      }

     function changeFunc() {
       if (gChangeTimer)
         clearTimeout(gChangeTimer);
       if (gChangeCallback)
         gChangeTimer = setTimeout(gChangeCallback, 500, gEditor.getValue());
     }

     gEditor = CodeMirror.fromTextArea(document.getElementById("code"), {
        lineNumbers: true,
        tabSize: 2,
        fixedGutter: true,
        extraGutterSize: 4,
        indentUnit: 2,
        indentWithTabs: false,
        matchBrackets: true,
        onGutterClick: foldFunc,
        onChange: changeFunc,
        mode: "text/html"
      });
  };

  function getEditableElement() {
    return document.querySelector(".CodeMirror");
  }
</script><
</body>
</html>
