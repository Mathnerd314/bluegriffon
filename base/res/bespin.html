<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <style type="text/css" media="screen">
    body {
        overflow: hidden;
    }
    
    #editor { 
        margin: 0;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
    }
  </style>
</head>
<body>

<pre id="editor"></pre>
<script src="resource://app/res/ace/themes-list.js" type="text/javascript" charset="utf-8"></script>
<script src="resource://app/res/ace/ace-uncompressed.js" type="text/javascript" charset="utf-8"></script>
<script src="resource://app/res/ace/mode-html.js" type="text/javascript" charset="utf-8"></script>
<script>
  var gEditor = null;
  var gTheme  = "clouds";

  function getEditableElement() {
    return document.getElementById("editor");
  }

  function installBespin(aKeyPressCallback, aTheme){
    getEditableElement().addEventListener("keypress", aKeyPressCallback, true);
    gTheme = aTheme;
  }

  function useTheme(aTheme) {
    if (gEditor) {
      gEditor.setTheme("ace/theme/" + aTheme);
      if (aTheme != gTheme)
        gTheme = aTheme;
    }
  }

  function getCurrentTheme()
  {
    return gTheme;
  }

  var head = document.querySelector("head");
  for (var i = 0; i < kTHEMES.length; i++) {
    var s = document.createElement("script");
    s.setAttribute("type", "text/javascript");
    s.setAttribute("charset", "utf-8");
    s.setAttribute("src", "resource://app/res/ace/theme-" + kTHEMES[i] + ".js");
    head.appendChild(s);
  }

  window.onload = function() {
    gEditor = ace.edit("editor");
    useTheme(gTheme);
    
    var HTMLMode = require("ace/mode/html").Mode;
    gEditor.getSession().setMode(new HTMLMode());

    var canon = require("pilot/canon");
    canon.removeCommand("findnext");
    canon.removeCommand("findprevious");
    canon.removeCommand("find");
    canon.removeCommand("replace");
    canon.removeCommand("gotoline");
  };
</script>
</body>
</html>
